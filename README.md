# Product Shelf Life API

API для поиска срока годности товаров по названию с использованием семантического поиска на базе OpenAI embeddings и FAISS индекса.

## 1. Что за проект и что делает

Проект предоставляет REST API для поиска товаров и получения информации о сроке их годности. Использует:
- **OpenAI embeddings** для семантического понимания названий товаров
- **FAISS индекс** для быстрого поиска похожих товаров
- **FastAPI** для backend API

Основная функциональность:
- Семантический поиск товаров по названию
- Получение информации о сроке годности
- Быстрый поиск благодаря FAISS индексу

## 2. Структура проекта

```
expiration-date/
├── app/
│   ├── __init__.py
│   ├── api/
│   │   ├── __init__.py
│   │   └── v1/
│   │       ├── __init__.py
│   │       ├── api.py              # Основной FastAPI файл
│   │       └── routers/
│   │           ├── __init__.py
│   │           └── predict.py      # Роутер для API эндпоинтов
│   ├── config.py                   # Конфигурация приложения
│   ├── create_faiss.py             # Скрипт создания FAISS индекса
│   ├── crud/
│   │   ├── __init__.py
│   │   └── product.py              # CRUD операции для товаров
│   ├── main.py                     # Точка входа приложения
│   ├── products.json               # Исходные данные о товарах
│   ├── products_info.json          # Обработанные данные для индекса
│   └── products_index.faiss       # FAISS индекс для поиска
├── env.example                     # Пример файла окружения
├── requirements.txt                 # Зависимости Python
└── README.md                       # Этот файл
```

## 3. API эндпоинты

- **POST** `/search/shelf-life` - Получение срока годности товара по названию

## 4. Как запускать

### 1. Создать виртуальное окружение и перейти в него
```bash
# Создание виртуального окружения
python -m venv .venv

# Активация виртуального окружения
# Windows:
.venv\Scripts\activate

### 2. Установить зависимости
```bash
pip install -r requirements.txt
```

### 3. Изменить .env
```bash
# Скопировать пример файла окружения
copy env.example .env

# Отредактировать .env файл, добавив необходимые переменные
# Например, API ключ OpenAI
```

### 4. Запустить с помощью python -m app.main
```bash
# Убедиться, что вы находитесь в корневой папке проекта
cd C:\Users\User\Desktop\expiration-date

# Запуск приложения
python -m app.main
```

### 5. Docker

#### 5.1 Сборка образа

Из корня проекта, где лежит Dockerfile, выполните:
```bash
docker build -t fastapi-faiss .
```

#### 5.2 Запуск контейнера с использованием файлов внутри образа
```bash
docker run -p 8007:8007 --env-file .env fastapi-faiss
```

## Важные замечания

- **Запускать нужно из корневой папки проекта** (где находится папка `app`)
- **Сервер запускается на порту 8007**
- **Перед запуском надо создать FAISS индекс** (если не скачан - он уже есть готовый в проекте)
- Если FAISS индекс отсутствует, создайте его командой:
  ```bash
  python -m app.create_faiss
  ```
- Если устанавливается не тот API KEY, удалите API KEY из env командой:
```bash
Remove-Item Env:\OPENAI_API_KEY
```
